
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="꿈꾸는 태태태의 공간">
    <title>누구나 할 수 있는 엑세스 로그 분석 따라 해보기 (by Elastic Stack) - 꿈꾸는 태태태의 공간</title>
    <meta name="author" content="taetaetae">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"taetaetae","sameAs":["https://facebook.com/taetaetae0","https://www.linkedin.com/in/태관-권-517825129/","mailto:taetaetae_@naver.com"],"image":"profile.jpg"},"articleBody":"필자가 Elastic Stack을 알게된건 2017년 어느 여름 동기형이 공부하고 있는것을 보고 호기심에 따라하며 시작하게 되었다. 그때까지만 해도 버전이 2.x 였는데 지금 글을 쓰고있는 2019년 2월초 최신버전이 6.6이니 정말 빠르게 변화하는것 같다. 빠르게 변화하는 버전만큼 사람들의 관심도 (드라마틱하게는 아니지만) 꾸준히 늘어나 개인적으로, 그리고 실무에서도 활용하는 범위가 많아지고 있는것 같다.\n  trends.embed.renderExploreWidget(\"TIMESERIES\", {\"comparisonItem\":[{\"keyword\":\"elasticsearch\",\"geo\":\"KR\",\"time\":\"today 5-y\"}],\"category\":0,\"property\":\"\"}, {\"exploreQuery\":\"date=today%205-y&geo=KR&q=elasticsearch\",\"guestPath\":\"https://trends.google.co.kr:443/trends/embed/\"}); \n\n그래서 그런지 최근들어 (아주 코딱지만큼 조금이라도 더 해본) 필자에게 Elastic Stack 사용방법에 대해 물어보는 주변 지인들이 늘어나고 있다. 그리고 예전에 한창 공부했을때의 버전보다 많이 바꼈기에 이 기회에 “그대로 따라만 하면 Elastic Stack을 구성할 수 있을만한 글”을 써보고자 한다. 사실 필자가 예전에 “도큐먼트를 보기엔 너무 어려워 보이는 느낌적인 느낌” 때문에 삽질하며 구성한 힘들었던 기억을 되살려 최대한 심플하고 처음 해보는 사람도 따라하기만 하면 “아~ 이게 Elastic Stack 이구나!”, “이런식으로 돌아가는 거구나!” 하는 도움을 주고 싶다. \n\n+ 그러면서 최신버전도 살펴보고… 1석2조, 이런게 바로 블로그를 하는 이유이지 않을까?다시한번 말하지만 도큐먼트가 최고 지침서이긴 하다…\n\nElastic 공식 홈페이지에 가면 각 제품군들에 대해 그림으로 된 자세한 설명과 도큐먼트가 있지만 이들을 어떤식으로 조합하여 사용하는지에 대한 전체적인 흐름을 볼 수 있는 곳은 없어 보인다. (지금 보면 도큐먼트가 그 어디보다 설명이 잘되어 있다고 생각되지만 사전 지식이 전혀없는 상태에서는 봐도봐도 어려워 보였다.)이번 포스팅에서는 Apache access log를 Elasticsearch에 인덱싱 하는 방법에 대해 설명해보고자 한다.\n# 전체적인 흐름필자는 글보다는 그림을 좋아하는 편이라 전체적인 흐름을 그림으로 먼저 보자.\n\n\n외부에서의 접근이 발생하면 apache 웹서버에서 설정한 경로에 access log가 파일로 생성이 되거나 있는 파일에 추가가 된다. 해당 파일에는 한줄당 하나의 엑세스 정보가 남게 된다.\nfileBeat에서 해당 파일을 트래킹 하고 있다가 라인이 추가되면 이 정보를 logstash 에게 전달해준다.\nlogastsh 는 filebeat에서 전달한 정보를 특정 port로 input 받는다.\n받은 정보를 filter 과정을 통해 각 정보를 분할 및 정제한다. (ip, uri, time 등)\n정리된 정보를 elasticsearch 에 ouput 으로 보낸다. (정확히 말하면 인덱싱을 한다.)\nelasticsearch 에 인덱싱 된 정보를 키바나를 통해 손쉽게 분석을 한다.\n\n한번의 설치고 일련의 과정이 뚝딱 된다면 너무 편하겠지만, 각각의 레이어가 나뉘어져있는 이유는 하는 역활이 전문적으로(?) 나뉘어져 있고 각 레이어에서는 세부 설정을 통해 보다 효율적으로 데이터를 관리할 수 있기 때문이다.\n\nbeats라는 레이어가 나오기 전에는 logstash에서 직접 file을 바라보곤 했었는데 beats가 logstash 보다 가벼운 shipper 목적으로 나온 agent 이다보니 통상 logstash 앞단에 filebeat를 위치시키곤 한다고 한다.\n\n전체적인 그림은 위와 같고, 이제 이 글을 보고있는 여러분들이 따라할 차례이다. 각 레이어별로 하나씩 설치를 해보며 구성을 해보자. 설치순서는 데이터 흐름의 순서에 맞춰 다음과 같은 순서로 설치를 해야 효율적으로 볼수가 있다. (아래순서대로 하지 않을경우 설치/시작/종료 를 각각의 타이밍에 맞추어 해줘야 할것 같아 복잡할것같다.)\n1elasticsearch → logstash → kibana → filebeat\n이 포스팅은 CentOS 7.4에서 Java 1.8, apache 2.2가 설치되어있다는 가정하에 보면 될듯하다. 또한 각 레이어별 설명은 구글링을 하거나 Elastic 공식 홈페이지에 가보면 자세히 나와있으니 기본 설명은 안하는것으로 하고, 각 레이어의 세부 설정은 하지 않는것으로 한다.\n# Elasticsearch공식 홈페이지1234567891011121314151617다운받고 압축풀고 심볼릭 경로 만들고 (심볼릭 경로는 선택사항)$ wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.6.0.tar.gz$ tar zxvf elasticsearch-6.6.0.tar.gz$ ln -s elasticsearch-6.6.0 elasticsearch설정 파일을 열고 추가해준다.$ cd elasticsearch/conf$ vi elasticsearch.ymlpath.data: /~~~/data/elasticsearch (기본경로에서 변경할때추가)path.logs: /~~~/logs/elasticsearchnetwork.host: 0.0.0.0 # 외부에서 접근이 가능하도록 (실제 ip를 적어줘도 됨)elasticsearch 의 시작과 종료를 조금이나마 편하게 하기위해 스크립트를 작성해줌 (이것또한 선택사항)$ cd ../bin$ echo &apos;./elasticsearch -d -p es.pid&apos; &gt; start.sh$ echo &apos;kill `cat es.pid`&apos; &gt; stop.sh$ chmod 755 start.sh stop.sh\n혹시 아래와 같은 에러가 발생할경우 공식문서 대로 진행해준다.1234ERROR: [1] bootstrap checks failed[1]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]&gt; sudo /sbin/sysctl -w vm.max_map_count=262144\n이렇게 하고 시작을 한뒤 브라우저에서 http://{ip}:9200 로 접속하면 다음과 같이 설치된 elasticsearch에 기본 정보가 나오게 되고 이렇게 elasticsearch의 설치 및 실행이 완료되었다.\n1234567891011121314151617&#123;\t&quot;name&quot;: &quot;@@@&quot;,\t&quot;cluster_name&quot;: &quot;elasticsearch&quot;,\t&quot;cluster_uuid&quot;: &quot;@@@&quot;,\t&quot;version&quot;: &#123;\t\t&quot;number&quot;: &quot;6.6.0&quot;,\t\t&quot;build_flavor&quot;: &quot;default&quot;,\t\t&quot;build_type&quot;: &quot;tar&quot;,\t\t&quot;build_hash&quot;: &quot;@@@&quot;,\t\t&quot;build_date&quot;: &quot;2019-01-24T11:27:09.439740Z&quot;,\t\t&quot;build_snapshot&quot;: false,\t\t&quot;lucene_version&quot;: &quot;7.6.0&quot;,\t\t&quot;minimum_wire_compatibility_version&quot;: &quot;5.6.0&quot;,\t\t&quot;minimum_index_compatibility_version&quot;: &quot;5.0.0&quot;\t&#125;,\t&quot;tagline&quot;: &quot;You Know, for Search&quot;&#125;\n# Logstash공식 홈페이지\n1234567891011121314151617181920212223242526272829303132다운을 받고 압축풀고 심볼릭 링크 설정$ wget https://artifacts.elastic.co/downloads/logstash/logstash-6.6.0.tar.gz$ tar -zxvf logstash-6.6.0.tar.gz$ ln -s logstash-6.6.0 logstashlogstash가 실행될때 설정값 파일을 만들어준다.$ cd logstash/config$ vi access_log.conf# beats 에서 5044 port 로 데이터를 input 받겠다는 의미input &#123;         beats &#123;                 port =&gt; &quot;5044&quot;        &#125;&#125;# grok 필터를 활용하여 엑세스로그 한줄을 아래처럼 파싱하겠다는 의미# 해당 필터는 apache의 로깅 설정에 의해 만들어지는 파일의 포멧에 맞추어 설정해야한다.filter &#123;        grok &#123;                match =&gt; &#123; &quot;message&quot; =&gt; [&quot;%&#123;IPORHOST:clientip&#125; (?:-|%&#123;USER:ident&#125;) (?:-|%&#123;USER:auth&#125;) \\[%&#123;HTTPDATE:timestamp&#125;\\] \\&quot;(?:%&#123;WORD:httpMethod&#125; %&#123;NOTSPACE:uri&#125;(?: HTTP/%&#123;NUMBER:httpversion&#125;)?|-)\\&quot; %&#123;NUMBER:responseCode&#125; (?:-|%&#123;NUMBER:bytes&#125;) (?:-|%&#123;NUMBER:bytes2&#125;)( \\&quot;%&#123;DATA:referrer&#125;\\&quot;)?( \\&quot;%&#123;DATA:user-agent&#125;\\&quot;)?&quot;] &#125;                remove_field =&gt; [&quot;timestamp&quot;,&quot;@version&quot;,&quot;path&quot;,&quot;tags&quot;,&quot;httpversion&quot;,&quot;bytes2&quot;]        &#125;&#125;# 정제된 데이터를 elasticsearch 에 인덱싱 하겟다는 의미# index 이름에 날짜 형태로 적어주면 인덱싱 하는 시점의 시간에 따라 인덱싱 이름이 자동으로 변경이 된다. (아래는 월별로 인덱스를 만들경우)output &#123;        elasticsearch &#123;                hosts =&gt; [ &quot;&#123;elasticsearch ip&#125;:9200&quot; ]                index =&gt; &quot;index-%&#123;+YYYY.MM&#125;&quot;        &#125;&#125;\n실행은 다음과 같이 &amp;연산자를 활용하여 background로 실행하게 한다.\n1$ bin/logstash -f config/access_log.conf &amp;\n이렇게 해서 실행을 하고 에러없이 정상적으로 실행이 된뒤 프로세스가 올라와 있으면 (ps -ef | grep logstash) 성공된 상태라 볼수있다.\n# Kibana공식 홈페이지\n12345678910역시 다운받고 압축풀고 심볼릭 링크 설정$ https://artifacts.elastic.co/downloads/kibana/kibana-6.6.0-linux-x86_64.tar.gz$ tar -zxvf kibana-6.6.0-linux-x86_64.tar.gz$ ln -s kibana-6.6.0-linux-x86_64 kibana외부에서 접근을 하기위해 ip를 적어주고, 연결할 elasticsearch 주소또한 적어준다.$ cd kibana/config$ vi kibana.ymlserver.host: &quot;@.@.@.@&quot;elasticsearch.hosts: [&quot;http://@.@.@.@:9200&quot;]\n실행은 bin 폴더로 이동후에 다음과 같이 실행시켜준다. 별다른 에러가 없으면 외부에서 접근이 가능한지 확인해보자.1234$ cd bin/$ nohup ./kibana &amp;접속 : http://@.@.@.@/5601\n# Filebeat공식 홈페이지\n1234567891011121314151617181920212223242526다운 → 압축해제 → 심볼릭링크$ wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.6.0-linux-x86_64.tar.gz$ tar -zxvf filebeat-6.6.0-linux-x86_64.tar.gz$ ln -s filebeat-6.6.0-linux-x86_64 filebeatfilebeat가 실행될때의 설정파일을 작성해준다.$ cd filebeat$ vi access_log.ymlfilebeat.prospectors:- type: log  enabled: true  paths:    - /~~~/logs/apache/access.log.* # 실제 엑세스 파일의 경로  tail_files: true # filebeat 시작시점 기준 파일 끝에서부터 로깅을 읽기 시작  ignore_older: 1m # filebeat 시작시점 기준 1분전의 내용은 무시  close_inactive: 2m  clean_inactive: 15mlogging.level: infologging.to_files: truelogging.files: # filebeat가 실행되면서 남기는 로깅파일 정보. 도큐먼트를 읽어보는것을 추천한다.  path: /~~~/logs/filebeat  name: test-filebeat-log  keepfiles: 7  rotateeverybytes: 524288000output.logstash: # 최종적으로 output 할 logstash의 정보를 입력해준다.  hosts: [&quot;@.@.@.@:5044&quot;]\n위와 같이 설정파일을 작성한 다음 아래처럼 실행을 하면 엑세스 파일의 내용이 filebeat를 거치고 logstash를 거쳐 최종적으로 elasticsearch 에 도달하게 된다. 기존에 엑세스 로그가 양이 많다면 그 정보를 다 읽는 시간이 걸리므로 주의한다. (filebeat 자체적으로 해당 파일의 offset을 관리하기 때문)\n1$ ./filebeat -c access_log.yml -d publish &amp;\n# 최종 확인왼쪽에는 해당 서버를 호출하고 오른쪽에는 키바나를 띄워논뒤 테스트를 해보면 아래처럼 access log를 확인이 가능하다. (apache만 띄워놓은 상태라 404상태로 나오긴 한다..) 불필요한 필드가 있다면 logstash 의 filter에서 remove 하면되고 키바나에서 각 정보를 가지고 다양한 유의미한 데이터를 만들어볼 수 있게 되었다.\n\n# 마치며막상 해보면 (해보기전에 느끼는 두려움보다는) 엄청나게 미친듯이 어렵지는 않는데… 맨땅에 해딩이든 뭐든 시작해보고 만들어보는게 중요하다고 다시한번 생각해본다. 필자는 elasticsearch 2.4버전에 대해 영어로된 문서를 보며 설치하고 구성하며 (왜 한글로 된 문서가 한명도 없을까…) 하는 아쉬움에 있었는데 이 글이 필자처럼 설치하는데 비슷한(?) 고충을 느낀 사람들에게 도움이 되었으면 한다.마지막으로 세부 설정값들로 인해 성능이나 기능이 다양하게 바뀔수 있으니 공식 도큐먼트를 보는것을 강력 추천하고 싶다.\n","dateCreated":"2019-02-10T14:37:31+09:00","dateModified":"2020-04-23T13:41:36+09:00","datePublished":"2019-02-10T14:37:31+09:00","description":"필자가 Elastic Stack을 알게된건 2017년 어느 여름 동기형이 공부하고 있는것을 보고 호기심에 따라하며 시작하게 되었다. 그때까지만 해도 버전이 2.x 였는데 지금 글을 쓰고있는 2019년 2월초 최신버전이 6.6이니 정말 빠르게 변화하는것 같다.","headline":"누구나 할 수 있는 엑세스 로그 분석 따라 해보기 (by Elastic Stack)","image":["elastic_stack.jpg"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/"},"publisher":{"@type":"Organization","name":"taetaetae","sameAs":["https://facebook.com/taetaetae0","https://www.linkedin.com/in/태관-권-517825129/","mailto:taetaetae_@naver.com"],"image":"profile.jpg","logo":{"@type":"ImageObject","url":"profile.jpg"}},"url":"https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/","keywords":"elasticsearch, logstash, kibana, filebeat","thumbnailUrl":"elastic_stack.jpg"}</script>
    <meta name="description" content="필자가 Elastic Stack을 알게된건 2017년 어느 여름 동기형이 공부하고 있는것을 보고 호기심에 따라하며 시작하게 되었다. 그때까지만 해도 버전이 2.x 였는데 지금 글을 쓰고있는 2019년 2월초 최신버전이 6.6이니 정말 빠르게 변화하는것 같다.">
<meta name="keywords" content="elasticsearch,logstash,kibana,filebeat">
<meta property="og:type" content="blog">
<meta property="og:title" content="누구나 할 수 있는 엑세스 로그 분석 따라 해보기 (by Elastic Stack)">
<meta property="og:url" content="https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/index.html">
<meta property="og:site_name" content="꿈꾸는 태태태의 공간">
<meta property="og:description" content="필자가 Elastic Stack을 알게된건 2017년 어느 여름 동기형이 공부하고 있는것을 보고 호기심에 따라하며 시작하게 되었다. 그때까지만 해도 버전이 2.x 였는데 지금 글을 쓰고있는 2019년 2월초 최신버전이 6.6이니 정말 빠르게 변화하는것 같다.">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-04-23T04:41:36.641Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="누구나 할 수 있는 엑세스 로그 분석 따라 해보기 (by Elastic Stack)">
<meta name="twitter:description" content="필자가 Elastic Stack을 알게된건 2017년 어느 여름 동기형이 공부하고 있는것을 보고 호기심에 따라하며 시작하게 되었다. 그때까지만 해도 버전이 2.x 였는데 지금 글을 쓰고있는 2019년 2월초 최신버전이 6.6이니 정말 빠르게 변화하는것 같다.">
<meta name="twitter:image" content="https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/concept.jpg">
    
    
        
    
    
    
        <meta property="og:image" content="https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/elastic_stack.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/elastic_stack.jpg" />
    
    
    
        <meta property="og:image" content="https://taetaetae.github.io/assets/images/profile.jpg"/>
    

    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-86432198-1', 'auto');
        ga('send', 'pageview');
    </script>


    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: "ca-pub-5788330009690816",
  enable_page_level_ads: true
  });
</script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">꿈꾸는 태태태의 공간</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">taetaetae</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Programmer</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/taetaetae0" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/in/태관-권-517825129/" target="_blank" rel="noopener" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:taetaetae_@naver.com" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>    
    <ins class="adsbygoogle"
   style="display:inline-block;max-width:250px;width:100%;max-height:380px;height:100%"
   data-ad-client="ca-pub-5788330009690816">
</ins>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    <div class="main-content-wrap">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- blog -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5788330009690816"
     data-ad-slot="9180895229"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
    </div>
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            누구나 할 수 있는 엑세스 로그 분석 따라 해보기 (by Elastic Stack)
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2019-02-10T14:37:31+09:00">
	
		    Feb 10, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/tech/">tech</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>필자가 Elastic Stack을 알게된건 2017년 어느 여름 동기형이 공부하고 있는것을 보고 호기심에 따라하며 시작하게 되었다. 그때까지만 해도 버전이 2.x 였는데 지금 글을 쓰고있는 2019년 2월초 최신버전이 6.6이니 정말 빠르게 변화하는것 같다. <a id="more"></a>빠르게 변화하는 버전만큼 사람들의 관심도 (드라마틱하게는 아니지만) 꾸준히 늘어나 개인적으로, 그리고 실무에서도 활용하는 범위가 많아지고 있는것 같다.</p>
<script type="text/javascript" src="https://ssl.gstatic.com/trends_nrtr/1709_RC01/embed_loader.js"></script> <script type="text/javascript"> trends.embed.renderExploreWidget("TIMESERIES", {"comparisonItem":[{"keyword":"elasticsearch","geo":"KR","time":"today 5-y"}],"category":0,"property":""}, {"exploreQuery":"date=today%205-y&geo=KR&q=elasticsearch","guestPath":"https://trends.google.co.kr:443/trends/embed/"}); </script>

<p>그래서 그런지 최근들어 <code>(아주 코딱지만큼 조금이라도 더 해본)</code> 필자에게 Elastic Stack 사용방법에 대해 물어보는 주변 지인들이 늘어나고 있다. 그리고 예전에 한창 공부했을때의 버전보다 많이 바꼈기에 이 기회에 “그대로 따라만 하면 Elastic Stack을 구성할 수 있을만한 글”을 써보고자 한다. 사실 필자가 예전에 “도큐먼트를 보기엔 너무 어려워 보이는 느낌적인 느낌” 때문에 삽질하며 구성한 힘들었던 기억을 되살려 최대한 심플하고 처음 해보는 사람도 따라하기만 하면 “아~ 이게 Elastic Stack 이구나!”, “이런식으로 돌아가는 거구나!” 하는 도움을 주고 싶다. </p>
<blockquote>
<p>+ 그러면서 최신버전도 살펴보고… 1석2조, 이런게 바로 블로그를 하는 이유이지 않을까?<br>다시한번 말하지만 도큐먼트가 최고 지침서이긴 하다…</p>
</blockquote>
<p><a href="https://www.elastic.co/kr/products" target="_blank" rel="noopener">Elastic 공식 홈페이지</a>에 가면 각 제품군들에 대해 그림으로 된 자세한 설명과 도큐먼트가 있지만 이들을 어떤식으로 조합하여 사용하는지에 대한 전체적인 흐름을 볼 수 있는 곳은 없어 보인다. (지금 보면 도큐먼트가 그 어디보다 설명이 잘되어 있다고 생각되지만 사전 지식이 전혀없는 상태에서는 봐도봐도 어려워 보였다.)<br>이번 포스팅에서는 <strong>Apache access log를 Elasticsearch에 인덱싱 하는 방법</strong>에 대해 설명해보고자 한다.</p>
<h4 id="전체적인-흐름"><a href="#전체적인-흐름" class="headerlink" title="# 전체적인 흐름"></a># 전체적인 흐름</h4><p>필자는 글보다는 그림을 좋아하는 편이라 전체적인 흐름을 그림으로 먼저 보자.</p>
<div class="figure center" style="width:;"><a class="fancybox" href="concept.jpg" title="" data-caption="" data-fancybox="default"><img class="fig-img" src="concept.jpg" alt=""></a></div>
<ol>
<li>외부에서의 접근이 발생하면 apache 웹서버에서 설정한 경로에 access log가 파일로 생성이 되거나 있는 파일에 추가가 된다. 해당 파일에는 한줄당 하나의 엑세스 정보가 남게 된다.</li>
<li>fileBeat에서 해당 파일을 트래킹 하고 있다가 라인이 추가되면 이 정보를 logstash 에게 전달해준다.</li>
<li>logastsh 는 filebeat에서 전달한 정보를 특정 port로 input 받는다.</li>
<li>받은 정보를 filter 과정을 통해 각 정보를 분할 및 정제한다. (ip, uri, time 등)</li>
<li>정리된 정보를 elasticsearch 에 ouput 으로 보낸다. (정확히 말하면 인덱싱을 한다.)</li>
<li>elasticsearch 에 인덱싱 된 정보를 키바나를 통해 손쉽게 분석을 한다.</li>
</ol>
<p>한번의 설치고 일련의 과정이 뚝딱 된다면 너무 편하겠지만, 각각의 레이어가 나뉘어져있는 이유는 하는 역활이 전문적으로(?) 나뉘어져 있고 각 레이어에서는 세부 설정을 통해 보다 효율적으로 데이터를 관리할 수 있기 때문이다.</p>
<blockquote>
<p>beats라는 레이어가 나오기 전에는 logstash에서 직접 file을 바라보곤 했었는데 beats가 logstash 보다 가벼운 shipper 목적으로 나온 agent 이다보니 통상 logstash 앞단에 filebeat를 위치시키곤 한다고 한다.</p>
</blockquote>
<p>전체적인 그림은 위와 같고, 이제 이 글을 보고있는 여러분들이 따라할 차례이다. 각 레이어별로 하나씩 설치를 해보며 구성을 해보자. 설치순서는 데이터 흐름의 순서에 맞춰 다음과 같은 순서로 설치를 해야 효율적으로 볼수가 있다. (아래순서대로 하지 않을경우 설치/시작/종료 를 각각의 타이밍에 맞추어 해줘야 할것 같아 복잡할것같다.)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch → logstash → kibana → filebeat</span><br></pre></td></tr></table></figure>
<p>이 포스팅은 CentOS 7.4에서 Java 1.8, apache 2.2가 설치되어있다는 가정하에 보면 될듯하다. 또한 각 레이어별 설명은 구글링을 하거나 Elastic 공식 홈페이지에 가보면 자세히 나와있으니 기본 설명은 안하는것으로 하고, 각 레이어의 세부 설정은 하지 않는것으로 한다.</p>
<h4 id="Elasticsearch"><a href="#Elasticsearch" class="headerlink" title="# Elasticsearch"></a># Elasticsearch</h4><p><a href="https://www.elastic.co/kr/products/elasticsearch" target="_blank" rel="noopener">공식 홈페이지</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">다운받고 압축풀고 심볼릭 경로 만들고 (심볼릭 경로는 선택사항)</span><br><span class="line">$ wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.6.0.tar.gz</span><br><span class="line">$ tar zxvf elasticsearch-6.6.0.tar.gz</span><br><span class="line">$ ln -s elasticsearch-6.6.0 elasticsearch</span><br><span class="line"></span><br><span class="line">설정 파일을 열고 추가해준다.</span><br><span class="line">$ cd elasticsearch/conf</span><br><span class="line">$ vi elasticsearch.yml</span><br><span class="line">path.data: /~~~/data/elasticsearch (기본경로에서 변경할때추가)</span><br><span class="line">path.logs: /~~~/logs/elasticsearch</span><br><span class="line">network.host: 0.0.0.0 # 외부에서 접근이 가능하도록 (실제 ip를 적어줘도 됨)</span><br><span class="line"></span><br><span class="line">elasticsearch 의 시작과 종료를 조금이나마 편하게 하기위해 스크립트를 작성해줌 (이것또한 선택사항)</span><br><span class="line">$ cd ../bin</span><br><span class="line">$ echo &apos;./elasticsearch -d -p es.pid&apos; &gt; start.sh</span><br><span class="line">$ echo &apos;kill `cat es.pid`&apos; &gt; stop.sh</span><br><span class="line">$ chmod 755 start.sh stop.sh</span><br></pre></td></tr></table></figure></p>
<p>혹시 아래와 같은 에러가 발생할경우 <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docker.html#docker-cli-run-prod-mode" target="_blank" rel="noopener">공식문서</a> 대로 진행해준다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ERROR: [1] bootstrap checks failed</span><br><span class="line">[1]: max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</span><br><span class="line"></span><br><span class="line">&gt; sudo /sbin/sysctl -w vm.max_map_count=262144</span><br></pre></td></tr></table></figure></p>
<p>이렇게 하고 시작을 한뒤 브라우저에서 <code>http://{ip}:9200</code> 로 접속하면 다음과 같이 설치된 elasticsearch에 기본 정보가 나오게 되고 이렇게 elasticsearch의 설치 및 실행이 완료되었다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;name&quot;: &quot;@@@&quot;,</span><br><span class="line">	&quot;cluster_name&quot;: &quot;elasticsearch&quot;,</span><br><span class="line">	&quot;cluster_uuid&quot;: &quot;@@@&quot;,</span><br><span class="line">	&quot;version&quot;: &#123;</span><br><span class="line">		&quot;number&quot;: &quot;6.6.0&quot;,</span><br><span class="line">		&quot;build_flavor&quot;: &quot;default&quot;,</span><br><span class="line">		&quot;build_type&quot;: &quot;tar&quot;,</span><br><span class="line">		&quot;build_hash&quot;: &quot;@@@&quot;,</span><br><span class="line">		&quot;build_date&quot;: &quot;2019-01-24T11:27:09.439740Z&quot;,</span><br><span class="line">		&quot;build_snapshot&quot;: false,</span><br><span class="line">		&quot;lucene_version&quot;: &quot;7.6.0&quot;,</span><br><span class="line">		&quot;minimum_wire_compatibility_version&quot;: &quot;5.6.0&quot;,</span><br><span class="line">		&quot;minimum_index_compatibility_version&quot;: &quot;5.0.0&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;tagline&quot;: &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Logstash"><a href="#Logstash" class="headerlink" title="# Logstash"></a># Logstash</h4><p><a href="https://www.elastic.co/kr/products/logstash" target="_blank" rel="noopener">공식 홈페이지</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">다운을 받고 압축풀고 심볼릭 링크 설정</span><br><span class="line">$ wget https://artifacts.elastic.co/downloads/logstash/logstash-6.6.0.tar.gz</span><br><span class="line">$ tar -zxvf logstash-6.6.0.tar.gz</span><br><span class="line">$ ln -s logstash-6.6.0 logstash</span><br><span class="line"></span><br><span class="line">logstash가 실행될때 설정값 파일을 만들어준다.</span><br><span class="line">$ cd logstash/config</span><br><span class="line">$ vi access_log.conf</span><br><span class="line"># beats 에서 5044 port 로 데이터를 input 받겠다는 의미</span><br><span class="line">input &#123; </span><br><span class="line">        beats &#123; </span><br><span class="line">                port =&gt; &quot;5044&quot;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># grok 필터를 활용하여 엑세스로그 한줄을 아래처럼 파싱하겠다는 의미</span><br><span class="line"># 해당 필터는 apache의 로깅 설정에 의해 만들어지는 파일의 포멧에 맞추어 설정해야한다.</span><br><span class="line">filter &#123;</span><br><span class="line">        grok &#123;</span><br><span class="line">                match =&gt; &#123; &quot;message&quot; =&gt; [&quot;%&#123;IPORHOST:clientip&#125; (?:-|%&#123;USER:ident&#125;) (?:-|%&#123;USER:auth&#125;) \[%&#123;HTTPDATE:timestamp&#125;\] \&quot;(?:%&#123;WORD:httpMethod&#125; %&#123;NOTSPACE:uri&#125;(?: HTTP/%&#123;NUMBER:httpversion&#125;)?|-)\&quot; %&#123;NUMBER:responseCode&#125; (?:-|%&#123;NUMBER:bytes&#125;) (?:-|%&#123;NUMBER:bytes2&#125;)( \&quot;%&#123;DATA:referrer&#125;\&quot;)?( \&quot;%&#123;DATA:user-agent&#125;\&quot;)?&quot;] &#125;</span><br><span class="line">                remove_field =&gt; [&quot;timestamp&quot;,&quot;@version&quot;,&quot;path&quot;,&quot;tags&quot;,&quot;httpversion&quot;,&quot;bytes2&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 정제된 데이터를 elasticsearch 에 인덱싱 하겟다는 의미</span><br><span class="line"># index 이름에 날짜 형태로 적어주면 인덱싱 하는 시점의 시간에 따라 인덱싱 이름이 자동으로 변경이 된다. (아래는 월별로 인덱스를 만들경우)</span><br><span class="line">output &#123;</span><br><span class="line">        elasticsearch &#123;</span><br><span class="line">                hosts =&gt; [ &quot;&#123;elasticsearch ip&#125;:9200&quot; ]</span><br><span class="line">                index =&gt; &quot;index-%&#123;+YYYY.MM&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>실행은 다음과 같이 <code>&amp;</code>연산자를 활용하여 background로 실행하게 한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bin/logstash -f config/access_log.conf &amp;</span><br></pre></td></tr></table></figure>
<p>이렇게 해서 실행을 하고 에러없이 정상적으로 실행이 된뒤 프로세스가 올라와 있으면 (<code>ps -ef | grep logstash</code>) 성공된 상태라 볼수있다.</p>
<h4 id="Kibana"><a href="#Kibana" class="headerlink" title="# Kibana"></a># Kibana</h4><p><a href="https://www.elastic.co/kr/products/kibana" target="_blank" rel="noopener">공식 홈페이지</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">역시 다운받고 압축풀고 심볼릭 링크 설정</span><br><span class="line">$ https://artifacts.elastic.co/downloads/kibana/kibana-6.6.0-linux-x86_64.tar.gz</span><br><span class="line">$ tar -zxvf kibana-6.6.0-linux-x86_64.tar.gz</span><br><span class="line">$ ln -s kibana-6.6.0-linux-x86_64 kibana</span><br><span class="line"></span><br><span class="line">외부에서 접근을 하기위해 ip를 적어주고, 연결할 elasticsearch 주소또한 적어준다.</span><br><span class="line">$ cd kibana/config</span><br><span class="line">$ vi kibana.yml</span><br><span class="line">server.host: &quot;@.@.@.@&quot;</span><br><span class="line">elasticsearch.hosts: [&quot;http://@.@.@.@:9200&quot;]</span><br></pre></td></tr></table></figure>
<p>실행은 bin 폴더로 이동후에 다음과 같이 실행시켜준다. 별다른 에러가 없으면 외부에서 접근이 가능한지 확인해보자.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cd bin/</span><br><span class="line">$ nohup ./kibana &amp;</span><br><span class="line"></span><br><span class="line">접속 : http://@.@.@.@/5601</span><br></pre></td></tr></table></figure></p>
<h4 id="Filebeat"><a href="#Filebeat" class="headerlink" title="# Filebeat"></a># Filebeat</h4><p><a href="https://www.elastic.co/kr/products/beats" target="_blank" rel="noopener">공식 홈페이지</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">다운 → 압축해제 → 심볼릭링크</span><br><span class="line">$ wget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-6.6.0-linux-x86_64.tar.gz</span><br><span class="line">$ tar -zxvf filebeat-6.6.0-linux-x86_64.tar.gz</span><br><span class="line">$ ln -s filebeat-6.6.0-linux-x86_64 filebeat</span><br><span class="line"></span><br><span class="line">filebeat가 실행될때의 설정파일을 작성해준다.</span><br><span class="line">$ cd filebeat</span><br><span class="line">$ vi access_log.yml</span><br><span class="line">filebeat.prospectors:</span><br><span class="line">- type: log</span><br><span class="line">  enabled: true</span><br><span class="line">  paths:</span><br><span class="line">    - /~~~/logs/apache/access.log.* # 실제 엑세스 파일의 경로</span><br><span class="line">  tail_files: true # filebeat 시작시점 기준 파일 끝에서부터 로깅을 읽기 시작</span><br><span class="line">  ignore_older: 1m # filebeat 시작시점 기준 1분전의 내용은 무시</span><br><span class="line">  close_inactive: 2m</span><br><span class="line">  clean_inactive: 15m</span><br><span class="line">logging.level: info</span><br><span class="line">logging.to_files: true</span><br><span class="line">logging.files: # filebeat가 실행되면서 남기는 로깅파일 정보. 도큐먼트를 읽어보는것을 추천한다.</span><br><span class="line">  path: /~~~/logs/filebeat</span><br><span class="line">  name: test-filebeat-log</span><br><span class="line">  keepfiles: 7</span><br><span class="line">  rotateeverybytes: 524288000</span><br><span class="line">output.logstash: # 최종적으로 output 할 logstash의 정보를 입력해준다.</span><br><span class="line">  hosts: [&quot;@.@.@.@:5044&quot;]</span><br></pre></td></tr></table></figure>
<p>위와 같이 설정파일을 작성한 다음 아래처럼 실행을 하면 엑세스 파일의 내용이 filebeat를 거치고 logstash를 거쳐 최종적으로 elasticsearch 에 도달하게 된다. 기존에 엑세스 로그가 양이 많다면 그 정보를 다 읽는 시간이 걸리므로 주의한다. (filebeat 자체적으로 해당 파일의 offset을 관리하기 때문)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./filebeat -c access_log.yml -d publish &amp;</span><br></pre></td></tr></table></figure>
<h4 id="최종-확인"><a href="#최종-확인" class="headerlink" title="# 최종 확인"></a># 최종 확인</h4><p>왼쪽에는 해당 서버를 호출하고 오른쪽에는 키바나를 띄워논뒤 테스트를 해보면 아래처럼 access log를 확인이 가능하다. (apache만 띄워놓은 상태라 404상태로 나오긴 한다..) 불필요한 필드가 있다면 logstash 의 filter에서 remove 하면되고 키바나에서 각 정보를 가지고 다양한 유의미한 데이터를 만들어볼 수 있게 되었다.</p>
<div class="figure center" style="width:;"><a class="fancybox" href="kibana.jpg" title="" data-caption="" data-fancybox="default"><img class="fig-img" src="kibana.jpg" alt=""></a></div>
<h4 id="마치며"><a href="#마치며" class="headerlink" title="# 마치며"></a># 마치며</h4><p>막상 해보면 (해보기전에 느끼는 두려움보다는) 엄청나게 미친듯이 어렵지는 않는데… 맨땅에 해딩이든 뭐든 시작해보고 만들어보는게 중요하다고 다시한번 생각해본다. 필자는 elasticsearch 2.4버전에 대해 영어로된 문서를 보며 설치하고 구성하며 (왜 한글로 된 문서가 한명도 없을까…) 하는 아쉬움에 있었는데 이 글이 필자처럼 설치하는데 비슷한(?) 고충을 느낀 사람들에게 도움이 되었으면 한다.<br>마지막으로 세부 설정값들로 인해 성능이나 기능이 다양하게 바뀔수 있으니 <a href="https://www.elastic.co/guide/kr/index.html" target="_blank" rel="noopener">공식 도큐먼트</a>를 보는것을 강력 추천하고 싶다.</p>

            

        </div>
    </div>
    <style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#000000 !important;background-color:#FFDD00 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 22px !important;letter-spacing: 0.6px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"><center><br><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/taetaetae"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span></a>
    <a href="https://qr.kakaopay.com/281006011000029652324500" target="_blank"><img src="https://i.imgur.com/peaYpjh.png" style="height: 28px;"></a>
    </center>
    <div id="post-footer" class="post-footer main-content-wrap">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- blog -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5788330009690816"
     data-ad-slot="9180895229"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/elasticsearch/">elasticsearch</a> <a class="tag tag--primary tag--small t-link" href="/tags/filebeat/">filebeat</a> <a class="tag tag--primary tag--small t-link" href="/tags/kibana/">kibana</a> <a class="tag tag--primary tag--small t-link" href="/tags/logstash/">logstash</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/02/17/daily-dev-blog-3/" data-tooltip="기술블로그 구독서비스 개발 후기 - 3부" aria-label="PREVIOUS: 기술블로그 구독서비스 개발 후기 - 3부">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/01/10/spring-redirect-oom/" data-tooltip="Spring MVC Redirect 처리중에 발생한 Out Of Memory 원인 분석하기" aria-label="NEXT: Spring MVC Redirect 처리중에 발생한 Out Of Memory 원인 분석하기">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                
        <!--  utteranc comment -->
        
        <script src="https://utteranc.es/client.js"
                repo="taetaetae/blog-comment"
                issue-term="pathname"
                label="Comment"
                theme="github-light"
                crossorigin="anonymous"
                async>
        </script>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 taetaetae. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/02/17/daily-dev-blog-3/" data-tooltip="기술블로그 구독서비스 개발 후기 - 3부" aria-label="PREVIOUS: 기술블로그 구독서비스 개발 후기 - 3부">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2019/01/10/spring-redirect-oom/" data-tooltip="Spring MVC Redirect 처리중에 발생한 Out Of Memory 원인 분석하기" aria-label="NEXT: Spring MVC Redirect 처리중에 발생한 Out Of Memory 원인 분석하기">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="5">
    <i id="btn-close-shareoptions" class="fa fa-times"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/">
                    <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/">
                    <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https://taetaetae.github.io/2019/02/10/access-log-to-elastic-stack/">
                    <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">taetaetae</h4>
        
            <div id="about-card-bio"><p>Programmer</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Naver Corp.</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                korea
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover_2.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->

    



    </body>
</html>
