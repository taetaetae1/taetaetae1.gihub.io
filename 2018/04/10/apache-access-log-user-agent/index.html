
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="꿈꾸는 태태태의 공간">
    <title>내 서버에는 누가 들어오는걸까? (실시간 user-agent 분석기) - 꿈꾸는 태태태의 공간</title>
    <meta name="author" content="taetaetae">
    
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"taetaetae","sameAs":["https://facebook.com/taetaetae0","https://www.linkedin.com/in/태관-권-517825129/","mailto:taetaetae_@naver.com"],"image":"profile.jpg"},"articleBody":"Desktop 및 스마트폰의 대중화로 다양한 OS와 브라우저들을 사용하게 되었다. 이때, 내가 운영하는 웹서버에 들어오는 사람들은 무슨 기기로 접속을 하는 것일까? 혹여 특정 OS의 특정 브라우저에서만 안되는 버그를 잡기 위해 몇일밤을 고생하며 겨우 수정했는데… 과연 그 OS의 브라우저에서는 접속은 하기나 하는걸까? (ㅠㅠ) 만약, 접속 사용자의 Device 정보를 알고있다면 고생하며 버그를 잡기 전에 먼저 해당 Device 사용율을 체크해 볼수도 있고(수정이 아닌 간단한 얼럿으로 해결한다거나?) 비지니스 모델까지 생각해야하는 서비스라면 타겟팅을 정하는 등 다양한 활용도가 높은 것이 바로 User-Agent라고 한다(이하 UA). 일반 Apache 를 웹서버로 운영하고 있다고 가정을 하고 어떻게 분석을 할수 있었는지, 그리고 분석을 하며 좀더 우아한(?) 방법은 없는지 알아 보고자 한다. \n# User-Agent가 뭐야?백문이 불여일타(?)라 했던가, 우선 http://www.useragentstring.com 를 들어가보자. 그러면 자신의 OS 및 브라우저 등 정보를 파싱해서 보여주는데 위키백과에 따르면 ‘사용자를 대신하여 일을 수행하는 소프트웨어 에이전트’라고 한다. 즉, UA만 알아도 어떤 기기/브라우저를 사용하는지 알 수 있다는것.mozilla에 가보면 스팩 등 다양한 UA를 볼수가 있는데 특히 맨 아래보면 기기/브라우저별로 지원정보가 나와있다. 여기서도 보면 모든 모바일 삼성 브라우저를 제외하고는 전부 지원이 되는걸 확인할수 있다.출처 : developer.mozilla.org출처 : developer.mozilla.org\n# 기존의 방법그럼 어떻게 내 서버에 들어온 사용자들의 UA를 확인할 수 있을까? (앞서 Apache를 웹서버로 운영한다고 했으니) Apache access log 에는 Apache에서 제공해주는 모듈을 이용해 접속한 클라이언트의 정보가 남겨지곤 한다. 그렇다면 이 access log를 리눅스 명령어든 엑셀로 뽑아서든지 활용해서 정규식으로 포맷팅 하고 그 결과를 다시 그룹화 시키면 얼추 원하는 데이터를 추출해 낼수 있다. ( 버거형들이 만들어둔 정규식을 가져다 사용할수도 있겠다. https://regexr.com/?37l4e )하지만, 우선 자동화가 안되어있어 데이터를 구하고 싶을때마다 귀차니즘에 걸릴수 있고 슈퍼 개발자 파워를 기반으로(?) 데이터 추출을 자동화 한들 실시간으로 보고싶을땐 제한사항이 많다.\n# 좀더 나은 방법(?)실시간 데이터를 모니터링 하는데에는 다양한 오픈소스와 다양한 툴이 있겠지만 경험이 부족한건지 아직까진 ElasticStack 만한걸 못본것 같다. 간단하게 설명을 하면 access log 를 사용하지 않고 front단에서 javascript 로 UA를 구한다음 이러한 정보를 받을수 있는 API를 만들어 그쪽으로 보내면 서버에서 해당 UA를 분석해서 카프카로 보내고 ..!@#$%^blabla…^^; 그림으로 보자.좀더 나은 방법좀더 나은 방법front단에서는 navigator.userAgent를 활용하여 UA를 구할수 있었고, API에서는 UA를 받고 파싱을 하는데 관련 코드는 다음과 같이 작성하였다.12345678910111213141516171819202122232425262728293031323334353637private static final String VERSION_SEPARATOR = \".\";private void userAgentParsingToMap(String userAgent, Map&lt;String, Object&gt; dataMap) &#123;    HashMap browser = Browser.lookup(userAgent);    HashMap os = OS.lookup(userAgent);    HashMap device = Device.lookup(userAgent);    dataMap.put(\"browserName\", browser.get(\"family\"));    dataMap.put(\"browserVersion\", getVersion(browser));    dataMap.put(\"osName\", os.get(\"family\"));    dataMap.put(\"osVersion\", getVersion(os));    dataMap.put(\"deviceModel\", device.get(\"model\"));    dataMap.put(\"deviceBrand\", device.get(\"brand\"));&#125;private String getVersion(HashMap dataMap) &#123;    String majorVersion = (String)dataMap.get(\"major\");    if (StringUtils.isEmpty(majorVersion)) &#123;        return StringUtils.EMPTY;    &#125;    String minorVersion = (String)dataMap.get(\"minor\");    String pathVersion = (String)dataMap.get(\"path\");    StringBuffer sb = new StringBuffer();    sb.append(majorVersion);    if (!StringUtils.isEmpty(minorVersion)) &#123;        sb.append(VERSION_SEPARATOR);        sb.append(minorVersion);    &#125;    if (!StringUtils.isEmpty(pathVersion)) &#123;        sb.append(VERSION_SEPARATOR);        sb.append(pathVersion);    &#125;    return sb.toString();&#125;\n참고로 Java단에서 UA를 파싱하는 parser가 여러가지가 있는데 그중 uap_clj라는 모듈이 그나마 잘 파싱이 되어서 사용하게 되었다.\n\n모듈별 비교 \n\n\n\n\n모듈\nBrowser\nOS\nDevice\n\n\n\n\neu.bitwalker.useragentutils.UserAgent\nO\n불명확함 (Android 5.x)\nX\n\n\nnet.sf.uadetector.UserAgentStringParser\nO\nO\n불명확함 (Smartphone)\n\n\nuap_clj.java.api.*\nO\nO\nO\n\n\n\n\nParsing 비교\n\nUA\n1&quot;Mozilla/5.0 (Linux; Android 5.1.1; Nexus 6 Build/LYZ28E) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36&quot;\n\n결과\n123- Browser : &#123;patch=3239, family=Chrome Mobile, major=63, minor=0&#125;- OS : &#123;patch=1, patch_minor=, family=Android, major=5, minor=1&#125;- Device : &#123;model=Nexus 6, family=Nexus 6, brand=Generic_Android&#125;\n\n\n\n\n위와 같이 구성을 하면 Elasticsearch에 인덱싱된 데이터를 Kibana에서 입맛에 맞게 실시간으로 볼수있게 되었다!하지만 API를 만드는 부분 + front에서 별도의 javascript가 들어간다는 부분 + 운영하는 모든 페이지에 해당 javascript를 넣어야지만 볼수있는 부분 등 약간 아쉬운 감이 있다. 뭔가 더 좋은 방법이 없을까? 깔끔하면서도 우아한 방법. 짱구를 열심히 더 굴려보자.\n# 좀더 우아한 방법?Logstash 에는 UA를 파싱해주는 filter plugin 이 있다고 한다. (링크) 이 방법과 예전에 포스팅한 access log 를 elasticsearch 에 인덱싱 하는 방법을 혼합하면 위에서 걱정했던 문제들을 아주 깔끔하게 해결할 수 있을것 같다.\n\n지난 포스팅 : 링크\n\n물론 글보다는 그림설명이 더 빠르니 전체적인 흐름을 그림으로 보자.좀더 우아한 방법좀더 우아한 방법① front 단에서 javascript로 UA를 구하고 ② 별도로 만든 API에 데이터를 전송한뒤 ③ API에서는 이를 또 파싱하는 작업을 logstash 의 user-agent filter plugin으로 깔끔하게 해결할 수 있었다.우선 apache에서 access log format 은 다음과 같고1&quot;%h %l %u %t \\&quot;%r\\&quot; %&gt;s %b %D \\&quot;%&#123;Referer&#125;i\\&quot; \\&quot;%&#123;User-Agent&#125;i\\&quot;&quot;\nlogstash쪽 설정은 다음과 같이 해주었다.1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162input &#123;        file &#123;                path =&gt; &quot;/~~~/access.log.*&quot;                start_position =&gt; &quot;beginning&quot;                codec =&gt; multiline &#123;                    pattern =&gt; &quot;^%&#123;IPORHOST&#125;&quot;                    negate =&gt; true                    what =&gt; previous                    auto_flush_interval =&gt; 1                &#125;        &#125;&#125;filter &#123;        grok &#123;                match =&gt; &#123; &quot;message&quot; =&gt; [&quot;%&#123;IPORHOST:clientip&#125; (?:-|%&#123;USER:ident&#125;) (?:-|%&#123;USER:auth&#125;) \\[%&#123;HTTPDATE:timestamp&#125;\\] \\&quot;(?:%&#123;WORD:httpMethod&#125; %&#123;NOTSPACE:uri&#125;(?: HTTP/%&#123;NUMBER:httpversion&#125;)?|-)\\&quot; %&#123;NUMBER:responseCode&#125; (?:-|%&#123;NUMBER:bytes&#125;) (?:-|%&#123;NUMBER:bytes2&#125;)( \\&quot;%&#123;DATA:referrer&#125;\\&quot;)?( \\&quot;%&#123;DATA:user-agent&#125;\\&quot;)?&quot;] &#125;                remove_field =&gt; [&quot;timestamp&quot;,&quot;@version&quot;,&quot;path&quot;,&quot;tags&quot;,&quot;httpversion&quot;,&quot;bytes2&quot;]        &#125;        useragent &#123;                source =&gt; &quot;user-agent&quot;        &#125;        if [os_major]  &#123;                mutate &#123;                        add_field =&gt; &#123;                                os_combine =&gt; &quot;%&#123;os&#125; %&#123;os_major&#125;.%&#123;os_minor&#125;&quot;                        &#125;                &#125;        &#125; else &#123;                 mutate &#123;                        add_field =&gt; &#123;                                os_combine =&gt; &quot;%&#123;os&#125;&quot;                        &#125;                &#125;        &#125;        if [os] =~ &quot;Windows&quot; &#123;                mutate &#123;                        update =&gt; &#123;                                &quot;os_name&quot; =&gt; &quot;Windows&quot;                        &#125;                &#125;        &#125;        if [os] =~ &quot;Mac&quot; &#123;                mutate &#123;                        update =&gt; &#123;                                &quot;os_name&quot; =&gt; &quot;Mac&quot;                        &#125;                &#125;        &#125;&#125;output &#123;        if [user-agent] != &quot;-&quot; and [user-agent] !~ &quot;Java&quot; &#123;                kafka &#123;                        bootstrap_servers =&gt; &quot;~~~&quot;                        topic_id =&gt; &quot;~~~&quot;                        codec =&gt; json&#123;&#125;                &#125;        &#125;&#125;\n설정하는데 가장 큰 어려웠던 점은 grok filter 패턴을 작성하는데 많은 시간을 할해야만 했다. 개인적으로 http://grokconstructor.appspot.com/do/match?example=2 에서 테스트 해보면서 패턴을 작성할수 있어 그나마 다행이였다.또한 logstash에서 파싱해주는 정보를 조금 다듬기 위해 mutate filter 를 사용해서 필드를 조합/수정 하였다.위처럼 적용을 하고 한두시간 수집을 해보니 Elasticsearch에 아래와 같은 도큐먼트가 생성이 된것을 확인할수 있었다.이 얼마나 우아한가...이 얼마나 우아한가...이 정보들을 잘 조합해서 Kibana에서 보면 다음과 같이 볼수 있다.user-agent 아 모바일 에서도 안드로이드 7.0에서 많이 들어오는구나~user-agent 아 모바일 에서도 안드로이드 7.0에서 많이 들어오는구나~UA는 아니지만 기왕 한김에 Access log의 uri를 분석해보면 아래처럼 볼수도 있겠다.외부에서 막 찔러 대는구나~ 시스템에 영향줄 정도면 막아야지!외부에서 막 찔러 대는구나~ 시스템에 영향줄 정도면 막아야지!\n# 마치며사실 logstash filter plugin을 작성하면서 뭔가 if-else로 분기처리한게 아쉽긴 하지만 만족할만한 결과를 얻을수 있어서 다행이라고 생각하고, 역시 데이터를 raw형태로 보는것보다 시각화해서 보는게 훨씬더 이해도를 높일수 있다는걸 다시금 실감할수 있었던 좋은 시간이였다.그런데.. 이 방법말고 더 우아한 방법은 없으려나..?;;\n","dateCreated":"2018-04-10T23:20:19+09:00","dateModified":"2020-04-23T13:41:36+09:00","datePublished":"2018-04-10T23:20:19+09:00","description":"Desktop 및 스마트폰의 대중화로 다양한 OS와 브라우저들을 사용하게 되었다. 이때, 내가 운영하는 웹서버에 들어오는 사람들은 무슨 기기로 접속을 하는 것일까? 혹여 특정 OS의 특정 브라우저에서만 안되는 버그를 잡기 위해 몇일밤을 고생하며 겨우 수정했는데… 과연 그 OS의 브라우저에서는 접속은 하기나 하는걸까? (ㅠㅠ)","headline":"내 서버에는 누가 들어오는걸까? (실시간 user-agent 분석기)","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/"},"publisher":{"@type":"Organization","name":"taetaetae","sameAs":["https://facebook.com/taetaetae0","https://www.linkedin.com/in/태관-권-517825129/","mailto:taetaetae_@naver.com"],"image":"profile.jpg","logo":{"@type":"ImageObject","url":"profile.jpg"}},"url":"https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/","keywords":"user-agent, apache access log, Elasitcsearch, Logstash, Kibana"}</script>
    <meta name="description" content="Desktop 및 스마트폰의 대중화로 다양한 OS와 브라우저들을 사용하게 되었다. 이때, 내가 운영하는 웹서버에 들어오는 사람들은 무슨 기기로 접속을 하는 것일까? 혹여 특정 OS의 특정 브라우저에서만 안되는 버그를 잡기 위해 몇일밤을 고생하며 겨우 수정했는데… 과연 그 OS의 브라우저에서는 접속은 하기나 하는걸까? (ㅠㅠ)">
<meta name="keywords" content="user-agent,apache access log,Elasitcsearch,Logstash,Kibana">
<meta property="og:type" content="blog">
<meta property="og:title" content="내 서버에는 누가 들어오는걸까? (실시간 user-agent 분석기)">
<meta property="og:url" content="https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/index.html">
<meta property="og:site_name" content="꿈꾸는 태태태의 공간">
<meta property="og:description" content="Desktop 및 스마트폰의 대중화로 다양한 OS와 브라우저들을 사용하게 되었다. 이때, 내가 운영하는 웹서버에 들어오는 사람들은 무슨 기기로 접속을 하는 것일까? 혹여 특정 OS의 특정 브라우저에서만 안되는 버그를 잡기 위해 몇일밤을 고생하며 겨우 수정했는데… 과연 그 OS의 브라우저에서는 접속은 하기나 하는걸까? (ㅠㅠ)">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-04-23T04:41:36.660Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="내 서버에는 누가 들어오는걸까? (실시간 user-agent 분석기)">
<meta name="twitter:description" content="Desktop 및 스마트폰의 대중화로 다양한 OS와 브라우저들을 사용하게 되었다. 이때, 내가 운영하는 웹서버에 들어오는 사람들은 무슨 기기로 접속을 하는 것일까? 혹여 특정 OS의 특정 브라우저에서만 안되는 버그를 잡기 위해 몇일밤을 고생하며 겨우 수정했는데… 과연 그 OS의 브라우저에서는 접속은 하기나 하는걸까? (ㅠㅠ)">
<meta name="twitter:image" content="https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/browser_compatibility.png">
    
    
        
    
    
    
    
    
        <meta property="og:image" content="https://taetaetae.github.io/assets/images/profile.jpg"/>
    

    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/all.css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css">
    <link rel="stylesheet" href="/assets/css/thumbs.css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-86432198-1', 'auto');
        ga('send', 'pageview');
    </script>


    
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: "ca-pub-5788330009690816",
  enable_page_level_ads: true
  });
</script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">꿈꾸는 태태태의 공간</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">taetaetae</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Programmer</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/taetaetae0" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://www.linkedin.com/in/태관-권-517825129/" target="_blank" rel="noopener" title="LinkedIn">
                    
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:taetaetae_@naver.com" target="_blank" rel="noopener" title="Mail">
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>    
    <ins class="adsbygoogle"
   style="display:inline-block;max-width:250px;width:100%;max-height:380px;height:100%"
   data-ad-client="ca-pub-5788330009690816">
</ins>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    <div class="main-content-wrap">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- blog -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5788330009690816"
     data-ad-slot="9180895229"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
    </div>
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            내 서버에는 누가 들어오는걸까? (실시간 user-agent 분석기)
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2018-04-10T23:20:19+09:00">
	
		    Apr 10, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/tech/">tech</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>Desktop 및 스마트폰의 대중화로 다양한 OS와 브라우저들을 사용하게 되었다. 이때, 내가 운영하는 웹서버에 들어오는 사람들은 무슨 기기로 접속을 하는 것일까? 혹여 특정 OS의 특정 브라우저에서만 안되는 버그를 잡기 위해 몇일밤을 고생하며 겨우 수정했는데… 과연 그 OS의 브라우저에서는 접속은 하기나 하는걸까? (ㅠㅠ) <a id="more"></a><br>만약, 접속 사용자의 Device 정보를 알고있다면 고생하며 버그를 잡기 전에 먼저 해당 Device 사용율을 체크해 볼수도 있고(수정이 아닌 간단한 얼럿으로 해결한다거나?) 비지니스 모델까지 생각해야하는 서비스라면 타겟팅을 정하는 등 다양한 활용도가 높은 것이 바로 <code>User-Agent</code>라고 한다(이하 UA). 일반 Apache 를 웹서버로 운영하고 있다고 가정을 하고 어떻게 분석을 할수 있었는지, 그리고 분석을 하며 좀더 우아한(?) 방법은 없는지 알아 보고자 한다. </p>
<h3 id="User-Agent가-뭐야"><a href="#User-Agent가-뭐야" class="headerlink" title="# User-Agent가 뭐야?"></a># User-Agent가 뭐야?</h3><p>백문이 불여일타(?)라 했던가, 우선 <a href="http://www.useragentstring.com" target="_blank" rel="noopener">http://www.useragentstring.com</a> 를 들어가보자. 그러면 자신의 OS 및 브라우저 등 정보를 파싱해서 보여주는데 <a href="https://en.wikipedia.org/wiki/User_agent" target="_blank" rel="noopener">위키백과</a>에 따르면 ‘사용자를 대신하여 일을 수행하는 소프트웨어 에이전트’라고 한다. 즉, UA만 알아도 어떤 기기/브라우저를 사용하는지 알 수 있다는것.<br><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent" target="_blank" rel="noopener">mozilla</a>에 가보면 스팩 등 다양한 UA를 볼수가 있는데 특히 맨 아래보면 기기/브라우저별로 지원정보가 나와있다. 여기서도 보면 모든 모바일 삼성 브라우저를 제외하고는 전부 지원이 되는걸 확인할수 있다.<br><div class="figure center" style="width:;"><img class="fig-img" src="browser_compatibility.png" alt="출처 : developer.mozilla.org"><span class="image-caption">출처 : developer.mozilla.org</span><span class="caption">출처 : developer.mozilla.org</span></div></p>
<h3 id="기존의-방법"><a href="#기존의-방법" class="headerlink" title="# 기존의 방법"></a># 기존의 방법</h3><p>그럼 어떻게 내 서버에 들어온 사용자들의 UA를 확인할 수 있을까? (앞서 Apache를 웹서버로 운영한다고 했으니) Apache access log 에는 Apache에서 제공해주는 모듈을 이용해 접속한 클라이언트의 정보가 남겨지곤 한다. 그렇다면 이 access log를 리눅스 명령어든 엑셀로 뽑아서든지 활용해서 정규식으로 포맷팅 하고 그 결과를 다시 그룹화 시키면 얼추 원하는 데이터를 추출해 낼수 있다. ( 버거형들이 만들어둔 정규식을 가져다 사용할수도 있겠다. <a href="https://regexr.com/?37l4e" target="_blank" rel="noopener">https://regexr.com/?37l4e</a> )<br>하지만, 우선 자동화가 안되어있어 데이터를 구하고 싶을때마다 귀차니즘에 걸릴수 있고 슈퍼 개발자 파워를 기반으로(?) 데이터 추출을 자동화 한들 <code>실시간</code>으로 보고싶을땐 제한사항이 많다.</p>
<h3 id="좀더-나은-방법"><a href="#좀더-나은-방법" class="headerlink" title="# 좀더 나은 방법(?)"></a># 좀더 나은 방법(?)</h3><p>실시간 데이터를 모니터링 하는데에는 다양한 오픈소스와 다양한 툴이 있겠지만 경험이 부족한건지 아직까진 ElasticStack 만한걸 못본것 같다. 간단하게 설명을 하면 access log 를 사용하지 않고 front단에서 javascript 로 UA를 구한다음 이러한 정보를 받을수 있는 API를 만들어 그쪽으로 보내면 서버에서 해당 UA를 분석해서 카프카로 보내고 ..!@#$%^blabla…<br>^^; 그림으로 보자.<br><div class="figure center" style="width:;"><img class="fig-img" src="user_agent_method_1.png" alt="좀더 나은 방법"><span class="image-caption">좀더 나은 방법</span><span class="caption">좀더 나은 방법</span></div><br>front단에서는 <code>navigator.userAgent</code>를 활용하여 UA를 구할수 있었고, API에서는 UA를 받고 파싱을 하는데 관련 코드는 다음과 같이 작성하였다.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String VERSION_SEPARATOR = <span class="string">"."</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">userAgentParsingToMap</span><span class="params">(String userAgent, Map&lt;String, Object&gt; dataMap)</span> </span>&#123;</span><br><span class="line">    HashMap browser = Browser.lookup(userAgent);</span><br><span class="line">    HashMap os = OS.lookup(userAgent);</span><br><span class="line">    HashMap device = Device.lookup(userAgent);</span><br><span class="line"></span><br><span class="line">    dataMap.put(<span class="string">"browserName"</span>, browser.get(<span class="string">"family"</span>));</span><br><span class="line">    dataMap.put(<span class="string">"browserVersion"</span>, getVersion(browser));</span><br><span class="line">    dataMap.put(<span class="string">"osName"</span>, os.get(<span class="string">"family"</span>));</span><br><span class="line">    dataMap.put(<span class="string">"osVersion"</span>, getVersion(os));</span><br><span class="line">    dataMap.put(<span class="string">"deviceModel"</span>, device.get(<span class="string">"model"</span>));</span><br><span class="line">    dataMap.put(<span class="string">"deviceBrand"</span>, device.get(<span class="string">"brand"</span>));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> String <span class="title">getVersion</span><span class="params">(HashMap dataMap)</span> </span>&#123;</span><br><span class="line">    String majorVersion = (String)dataMap.get(<span class="string">"major"</span>);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isEmpty(majorVersion)) &#123;</span><br><span class="line">        <span class="keyword">return</span> StringUtils.EMPTY;</span><br><span class="line">    &#125;</span><br><span class="line">    String minorVersion = (String)dataMap.get(<span class="string">"minor"</span>);</span><br><span class="line">    String pathVersion = (String)dataMap.get(<span class="string">"path"</span>);</span><br><span class="line"></span><br><span class="line">    StringBuffer sb = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    sb.append(majorVersion);</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(minorVersion)) &#123;</span><br><span class="line">        sb.append(VERSION_SEPARATOR);</span><br><span class="line">        sb.append(minorVersion);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(pathVersion)) &#123;</span><br><span class="line">        sb.append(VERSION_SEPARATOR);</span><br><span class="line">        sb.append(pathVersion);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>참고로 Java단에서 UA를 파싱하는 parser가 여러가지가 있는데 그중 <code>uap_clj</code>라는 모듈이 그나마 잘 파싱이 되어서 사용하게 되었다.</p>
<ul>
<li>모듈별 비교 </li>
</ul>
<table>
<thead>
<tr>
<th>모듈</th>
<th>Browser</th>
<th>OS</th>
<th>Device</th>
</tr>
</thead>
<tbody>
<tr>
<td>eu.bitwalker.useragentutils.UserAgent</td>
<td>O</td>
<td>불명확함 (Android 5.x)</td>
<td>X</td>
</tr>
<tr>
<td>net.sf.uadetector.UserAgentStringParser</td>
<td>O</td>
<td>O</td>
<td>불명확함 (Smartphone)</td>
</tr>
<tr>
<td>uap_clj.java.api.*</td>
<td>O</td>
<td>O</td>
<td>O</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Parsing 비교</p>
<ul>
<li><p>UA</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Mozilla/5.0 (Linux; Android 5.1.1; Nexus 6 Build/LYZ28E) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>결과</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- Browser : &#123;patch=3239, family=Chrome Mobile, major=63, minor=0&#125;</span><br><span class="line">- OS : &#123;patch=1, patch_minor=, family=Android, major=5, minor=1&#125;</span><br><span class="line">- Device : &#123;model=Nexus 6, family=Nexus 6, brand=Generic_Android&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>위와 같이 구성을 하면 Elasticsearch에 인덱싱된 데이터를 Kibana에서 입맛에 맞게 실시간으로 볼수있게 되었다!<br>하지만 API를 만드는 부분 + front에서 별도의 javascript가 들어간다는 부분 + 운영하는 모든 페이지에 해당 javascript를 넣어야지만 볼수있는 부분 등 약간 아쉬운 감이 있다. 뭔가 더 좋은 방법이 없을까? 깔끔하면서도 <code>우아한</code> 방법. 짱구를 열심히 더 굴려보자.</p>
<h3 id="좀더-우아한-방법"><a href="#좀더-우아한-방법" class="headerlink" title="# 좀더 우아한 방법?"></a># 좀더 우아한 방법?</h3><p>Logstash 에는 UA를 파싱해주는 filter plugin 이 있다고 한다. (<a href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-useragent.html" target="_blank" rel="noopener">링크</a>) 이 방법과 예전에 포스팅한 access log 를 elasticsearch 에 인덱싱 하는 방법을 혼합하면 위에서 걱정했던 문제들을 아주 깔끔하게 해결할 수 있을것 같다.</p>
<blockquote>
<p>지난 포스팅 : <a href="https://taetaetae.github.io/2018/01/25/apache-access-log-to-es">링크</a></p>
</blockquote>
<p>물론 글보다는 그림설명이 더 빠르니 전체적인 흐름을 그림으로 보자.<br><div class="figure center" style="width:;"><img class="fig-img" src="user_agent_method_2.png" alt="좀더 우아한 방법"><span class="image-caption">좀더 우아한 방법</span><span class="caption">좀더 우아한 방법</span></div><br>① front 단에서 javascript로 UA를 구하고 ② 별도로 만든 API에 데이터를 전송한뒤 ③ API에서는 이를 또 파싱하는 작업을 logstash 의 <code>user-agent filter plugin</code>으로 깔끔하게 해결할 수 있었다.<br>우선 apache에서 access log format 은 다음과 같고<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b %D \&quot;%&#123;Referer&#125;i\&quot; \&quot;%&#123;User-Agent&#125;i\&quot;&quot;</span><br></pre></td></tr></table></figure></p>
<p>logstash쪽 설정은 다음과 같이 해주었다.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">        file &#123;</span><br><span class="line">                path =&gt; &quot;/~~~/access.log.*&quot;</span><br><span class="line">                start_position =&gt; &quot;beginning&quot;</span><br><span class="line">                codec =&gt; multiline &#123;</span><br><span class="line">                    pattern =&gt; &quot;^%&#123;IPORHOST&#125;&quot;</span><br><span class="line">                    negate =&gt; true</span><br><span class="line">                    what =&gt; previous</span><br><span class="line">                    auto_flush_interval =&gt; 1</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">filter &#123;</span><br><span class="line">        grok &#123;</span><br><span class="line">                match =&gt; &#123; &quot;message&quot; =&gt; [&quot;%&#123;IPORHOST:clientip&#125; (?:-|%&#123;USER:ident&#125;) (?:-|%&#123;USER:auth&#125;) \[%&#123;HTTPDATE:timestamp&#125;\] \&quot;(?:%&#123;WORD:httpMethod&#125; %&#123;NOTSPACE:uri&#125;(?: HTTP/%&#123;NUMBER:httpversion&#125;)?|-)\&quot; %&#123;NUMBER:responseCode&#125; (?:-|%&#123;NUMBER:bytes&#125;) (?:-|%&#123;NUMBER:bytes2&#125;)( \&quot;%&#123;DATA:referrer&#125;\&quot;)?( \&quot;%&#123;DATA:user-agent&#125;\&quot;)?&quot;] &#125;</span><br><span class="line">                remove_field =&gt; [&quot;timestamp&quot;,&quot;@version&quot;,&quot;path&quot;,&quot;tags&quot;,&quot;httpversion&quot;,&quot;bytes2&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">        useragent &#123;</span><br><span class="line">                source =&gt; &quot;user-agent&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        if [os_major]  &#123;</span><br><span class="line">                mutate &#123;</span><br><span class="line">                        add_field =&gt; &#123;</span><br><span class="line">                                os_combine =&gt; &quot;%&#123;os&#125; %&#123;os_major&#125;.%&#123;os_minor&#125;&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">                 mutate &#123;</span><br><span class="line">                        add_field =&gt; &#123;</span><br><span class="line">                                os_combine =&gt; &quot;%&#123;os&#125;&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        if [os] =~ &quot;Windows&quot; &#123;</span><br><span class="line">                mutate &#123;</span><br><span class="line">                        update =&gt; &#123;</span><br><span class="line">                                &quot;os_name&quot; =&gt; &quot;Windows&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if [os] =~ &quot;Mac&quot; &#123;</span><br><span class="line">                mutate &#123;</span><br><span class="line">                        update =&gt; &#123;</span><br><span class="line">                                &quot;os_name&quot; =&gt; &quot;Mac&quot;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output &#123;</span><br><span class="line">        if [user-agent] != &quot;-&quot; and [user-agent] !~ &quot;Java&quot; &#123;</span><br><span class="line">                kafka &#123;</span><br><span class="line">                        bootstrap_servers =&gt; &quot;~~~&quot;</span><br><span class="line">                        topic_id =&gt; &quot;~~~&quot;</span><br><span class="line">                        codec =&gt; json&#123;&#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>설정하는데 가장 큰 어려웠던 점은 grok filter 패턴을 작성하는데 많은 시간을 할해야만 했다. 개인적으로 <a href="http://grokconstructor.appspot.com/do/match?example=2" target="_blank" rel="noopener">http://grokconstructor.appspot.com/do/match?example=2</a> 에서 테스트 해보면서 패턴을 작성할수 있어 그나마 다행이였다.<br>또한 logstash에서 파싱해주는 정보를 조금 다듬기 위해 <code>mutate</code> filter 를 사용해서 필드를 조합/수정 하였다.<br>위처럼 적용을 하고 한두시간 수집을 해보니 Elasticsearch에 아래와 같은 도큐먼트가 생성이 된것을 확인할수 있었다.<br><div class="figure center" style="width:;"><img class="fig-img" src="user_agent_elasticsearch_document.jpg" alt="이 얼마나 우아한가..."><span class="image-caption">이 얼마나 우아한가...</span><span class="caption">이 얼마나 우아한가...</span></div><br>이 정보들을 잘 조합해서 Kibana에서 보면 다음과 같이 볼수 있다.<br><div class="figure center" style="width:;"><img class="fig-img" src="kibana_1.png" alt="user-agent 아 모바일 에서도 안드로이드 7.0에서 많이 들어오는구나~"><span class="image-caption">user-agent 아 모바일 에서도 안드로이드 7.0에서 많이 들어오는구나~</span><span class="caption">user-agent 아 모바일 에서도 안드로이드 7.0에서 많이 들어오는구나~</span></div><br>UA는 아니지만 기왕 한김에 Access log의 uri를 분석해보면 아래처럼 볼수도 있겠다.<br><div class="figure center" style="width:;"><img class="fig-img" src="kibana_2.png" alt="외부에서 막 찔러 대는구나~ 시스템에 영향줄 정도면 막아야지!"><span class="image-caption">외부에서 막 찔러 대는구나~ 시스템에 영향줄 정도면 막아야지!</span><span class="caption">외부에서 막 찔러 대는구나~ 시스템에 영향줄 정도면 막아야지!</span></div></p>
<h3 id="마치며"><a href="#마치며" class="headerlink" title="# 마치며"></a># 마치며</h3><p>사실 logstash filter plugin을 작성하면서 뭔가 if-else로 분기처리한게 아쉽긴 하지만 만족할만한 결과를 얻을수 있어서 다행이라고 생각하고, 역시 데이터를 raw형태로 보는것보다 시각화해서 보는게 훨씬더 이해도를 높일수 있다는걸 다시금 실감할수 있었던 좋은 시간이였다.<br>그런데.. 이 방법말고 더 우아한 방법은 없으려나..?;;</p>

            

        </div>
    </div>
    <style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#000000 !important;background-color:#FFDD00 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 22px !important;letter-spacing: 0.6px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"><center><br><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/taetaetae"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span></a>
    <a href="https://bit.ly/ddbSupport" target="_blank"><img src="https://i.imgur.com/peaYpjh.png" style="height: 28px;"></a>
    </center>
    <div id="post-footer" class="post-footer main-content-wrap">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- blog -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-5788330009690816"
     data-ad-slot="9180895229"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Elasitcsearch/">Elasitcsearch</a> <a class="tag tag--primary tag--small t-link" href="/tags/Kibana/">Kibana</a> <a class="tag tag--primary tag--small t-link" href="/tags/Logstash/">Logstash</a> <a class="tag tag--primary tag--small t-link" href="/tags/apache-access-log/">apache access log</a> <a class="tag tag--primary tag--small t-link" href="/tags/user-agent/">user-agent</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/04/29/apache-408-response-code/" data-tooltip="아파치 엑세스 로그에 408코드가?" aria-label="PREVIOUS: 아파치 엑세스 로그에 408코드가?">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/04/01/apache-gzip/" data-tooltip="gzip 설정으로 속도를 더 빠르게!" aria-label="NEXT: gzip 설정으로 속도를 더 빠르게!">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                
        <!--  utteranc comment -->
        
        <script src="https://utteranc.es/client.js"
                repo="taetaetae/blog-comment"
                issue-term="pathname"
                label="Comment"
                theme="github-light"
                crossorigin="anonymous"
                async>
        </script>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 taetaetae. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/04/29/apache-408-response-code/" data-tooltip="아파치 엑세스 로그에 408코드가?" aria-label="PREVIOUS: 아파치 엑세스 로그에 408코드가?">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2018/04/01/apache-gzip/" data-tooltip="gzip 설정으로 속도를 더 빠르게!" aria-label="NEXT: gzip 설정으로 속도를 더 빠르게!">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/" title="Share on Twitter">
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/" title="Share on Google+">
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="5">
    <i id="btn-close-shareoptions" class="fa fa-times"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/">
                    <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/">
                    <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https://taetaetae.github.io/2018/04/10/apache-access-log-user-agent/">
                    <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/profile.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">taetaetae</h4>
        
            <div id="about-card-bio"><p>Programmer</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Naver Corp.</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                korea
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover_2.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/jquery.fancybox.js"></script>
<script src="/assets/js/thumbs.js"></script>
<script src="/assets/js/tranquilpeak.js"></script>
<!--SCRIPTS END-->

    



    </body>
</html>
